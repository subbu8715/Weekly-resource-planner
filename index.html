<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resource Availability Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .status-cell {
            min-width: 120px;
            height: 80px;
            transition: transform 0.2s;
        }
        .status-cell:hover {
            transform: scale(1.05);
            z-index: 10;
        }
        /* Status Colors */
        .status-wfo { background-color: #166534; color: white; } /* Dark Green */
        .status-wfh { background-color: #86efac; color: #14532d; } /* Light Green */
        .status-planned-leave { background-color: #f97316; color: white; } /* Orange */
        .status-unplanned-leave { background-color: #b91c1c; color: white; } /* Dark Red */
        .status-default { background-color: #f3f4f6; } /* Gray */

        /* Modal backdrop */
        .modal-backdrop {
            background-color: rgba(0,0,0,0.5);
            transition: opacity 0.3s ease-in-out;
        }
        /* Hide scrollbar for the grid container */
        .table-container::-webkit-scrollbar {
            display: none;
        }
        .table-container {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 antialiased">

    <!-- Main Container -->
    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-6">
            <h1 class="text-4xl font-bold text-gray-900">Resource Availability Tracker</h1>
            <p id="week-range-display" class="text-xl text-gray-600 mt-2"></p>
        </header>

        <!-- Controls -->
        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
            <div class="flex items-center gap-2">
                <button id="prev-week-btn" class="bg-white px-4 py-2 rounded-lg shadow font-semibold hover:bg-gray-200 transition">- Week</button>
                <button id="today-btn" class="bg-white px-4 py-2 rounded-lg shadow font-semibold hover:bg-gray-200 transition">Today</button>
                <button id="next-week-btn" class="bg-white px-4 py-2 rounded-lg shadow font-semibold hover:bg-gray-200 transition">+ Week</button>
            </div>
            <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
                <button id="bulk-upload-btn" class="bg-green-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-green-700 transition shadow-md w-full sm:w-auto">
                    Bulk Upload
                </button>
                <button id="add-member-btn" class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-lg hover:bg-blue-700 transition shadow-md w-full sm:w-auto">
                    Add Team Member
                </button>
            </div>
        </div>

        <!-- Planner Grid -->
        <div class="bg-white rounded-xl shadow-lg p-4 overflow-hidden">
            <div id="planner-grid-container" class="table-container overflow-x-auto">
                <table class="w-full border-collapse">
                    <thead id="planner-head">
                        <!-- Header will be generated by JS -->
                    </thead>
                    <tbody id="planner-body">
                        <!-- Body will be generated by JS -->
                    </tbody>
                </table>
            </div>
             <div id="empty-state" class="hidden text-center py-16">
                <h3 class="text-xl font-semibold text-gray-700">Your planner is empty</h3>
                <p class="text-gray-500 mt-2">Click "Add Team Member" to get started.</p>
            </div>
        </div>
    </div>

    <!-- Add/Edit Member Modal -->
    <div id="member-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-md mx-auto">
            <h2 id="member-modal-title" class="text-2xl font-bold mb-6">Add New Member</h2>
            <form id="member-form">
                <input type="hidden" id="member-id">
                <div class="mb-4">
                    <label for="member-name" class="block text-sm font-medium text-gray-700">Employee Name</label>
                    <input type="text" id="member-name" placeholder="e.g., Jane Doe" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="member-role" class="block text-sm font-medium text-gray-700">Role</label>
                    <input type="text" id="member-role" placeholder="e.g., Project Manager" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="member-shift" class="block text-sm font-medium text-gray-700">Shift Timings</label>
                    <input type="text" id="member-shift" placeholder="e.g., 9 AM - 5 PM" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500" required>
                </div>
                <div class="mb-6">
                    <label for="member-region" class="block text-sm font-medium text-gray-700">Region Supported</label>
                    <input type="text" id="member-region" placeholder="e.g., APAC, EMEA" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="cancel-member-btn" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300">Cancel</button>
                    <button type="submit" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700">Save Member</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Set Status Modal -->
    <div id="status-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-sm mx-auto">
            <h2 class="text-2xl font-bold mb-2">Set Status</h2>
            <p id="status-modal-info" class="text-gray-600 mb-6"></p>
            <div class="grid grid-cols-1 gap-4 mb-6">
                <button data-status="wfo" class="status-btn status-wfo font-bold py-3 px-4 rounded-lg">Work from Office</button>
                <button data-status="wfh" class="status-btn status-wfh font-bold py-3 px-4 rounded-lg">Work from Home</button>
                <button data-status="planned-leave" class="status-btn status-planned-leave font-bold py-3 px-4 rounded-lg">Planned Leave</button>
                <button data-status="unplanned-leave" class="status-btn status-unplanned-leave font-bold py-3 px-4 rounded-lg">Unplanned Leave</button>
            </div>
            <div class="mb-4">
                <label for="status-comment" class="block text-sm font-medium text-gray-700">Comment (optional)</label>
                <input type="text" id="status-comment" placeholder="e.g., Doctor's appointment" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div class="flex justify-between items-center gap-4">
                 <button type="button" id="clear-status-btn" class="text-red-600 font-semibold hover:text-red-800">Clear Status</button>
                 <div>
                    <button type="button" id="cancel-status-btn" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 mr-2">Cancel</button>
                    <button type="button" id="save-status-btn" class="bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-blue-700">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Upload Modal -->
    <div id="bulk-upload-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-lg mx-auto">
            <h2 class="text-2xl font-bold mb-4">Bulk Upload Members</h2>
            <p class="text-gray-600 mb-6">
                Your CSV file must have a header row. The columns should be in the following order: <br>
                <code class="bg-gray-200 text-sm p-1 rounded mt-2 inline-block">Name, Role, Shift Timings, Region Supported</code>
            </p>
            <div class="mb-4">
                <label for="csv-file-input" class="block text-sm font-medium text-gray-700">CSV File</label>
                <input type="file" id="csv-file-input" accept=".csv" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
            </div>
            <p id="upload-status" class="text-sm text-green-600 h-5 mb-2"></p>
            <div class="flex justify-end gap-4">
                <button type="button" id="cancel-upload-btn" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300">Close</button>
            </div>
        </div>
    </div>

    <!-- Bulk Status Update Modal -->
    <div id="bulk-status-modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-lg shadow-2xl p-8 w-full max-w-sm mx-auto">
            <h2 class="text-2xl font-bold mb-2">Bulk Update Week</h2>
            <p id="bulk-status-modal-info" class="text-gray-600 mb-6"></p>
            <div class="grid grid-cols-1 gap-4 mb-6">
                <button data-status="wfo" class="bulk-status-btn status-wfo font-bold py-3 px-4 rounded-lg">Work from Office</button>
                <button data-status="wfh" class="bulk-status-btn status-wfh font-bold py-3 px-4 rounded-lg">Work from Home</button>
                <button data-status="planned-leave" class="bulk-status-btn status-planned-leave font-bold py-3 px-4 rounded-lg">Planned Leave</button>
                <button data-status="unplanned-leave" class="bulk-status-btn status-unplanned-leave font-bold py-3 px-4 rounded-lg">Unplanned Leave</button>
            </div>
            <div class="flex justify-end gap-4">
                <button type="button" id="cancel-bulk-status-btn" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300">Cancel</button>
            </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // STATE MANAGEMENT
        let currentDate = new Date();
        let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || [];
        let statuses = JSON.parse(localStorage.getItem('statuses')) || {};

        // DOM ELEMENTS
        const weekRangeDisplay = document.getElementById('week-range-display');
        const plannerHead = document.getElementById('planner-head');
        const plannerBody = document.getElementById('planner-body');
        const emptyState = document.getElementById('empty-state');
        const gridContainer = document.getElementById('planner-grid-container');

        // MODAL ELEMENTS
        const memberModal = document.getElementById('member-modal');
        const memberForm = document.getElementById('member-form');
        const memberModalTitle = document.getElementById('member-modal-title');
        const statusModal = document.getElementById('status-modal');
        const statusModalInfo = document.getElementById('status-modal-info');
        const bulkUploadModal = document.getElementById('bulk-upload-modal');
        const csvFileInput = document.getElementById('csv-file-input');
        const uploadStatus = document.getElementById('upload-status');
        const bulkStatusModal = document.getElementById('bulk-status-modal');
        const bulkStatusModalInfo = document.getElementById('bulk-status-modal-info');
        
        let selectedCellData = null;
        let selectedMemberIdForBulkUpdate = null;

        // DATE UTILS
        const getWeek = (date) => {
            const week = [];
            const tempDate = new Date(date);
            const dayOfWeek = tempDate.getDay(); // 0=Sun, 1=Mon, ..., 6=Sat

            // Find the date of the most recent Monday
            let monday = new Date(tempDate);
            let offset = dayOfWeek === 0 ? 6 : dayOfWeek - 1; // days to subtract to get to Monday
            monday.setDate(tempDate.getDate() - offset);

            for (let i = 0; i < 7; i++) { // Loop for 7 days: Monday to Sunday
                const day = new Date(monday);
                day.setDate(monday.getDate() + i);
                week.push(day);
            }
            return week;
        };
        
        const formatDate = (date, options) => date.toLocaleString('en-US', options);
        const toISODateString = (date) => date.toISOString().split('T')[0];

        // LOCAL STORAGE UTILS
        const saveData = () => {
            localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
            localStorage.setItem('statuses', JSON.stringify(statuses));
        };

        // RENDER FUNCTIONS
        const render = () => {
            const week = getWeek(currentDate);
            renderWeekHeader(week);
            renderPlanner(week);
            updateEmptyState();
        };

        const renderWeekHeader = (week) => {
            // Update main header
            const start = formatDate(week[0], { month: 'short', day: 'numeric' });
            const end = formatDate(week[6], { month: 'short', day: 'numeric', year: 'numeric' });
            weekRangeDisplay.textContent = `${start} - ${end}`;
            
            // Update table header
            plannerHead.innerHTML = '';
            const headerRow = document.createElement('tr');
            headerRow.innerHTML = `<th class="sticky left-0 bg-white p-2 border-b-2 border-gray-200 z-20">Team Member</th>`;
            week.forEach(day => {
                const isToday = toISODateString(day) === toISODateString(new Date());
                headerRow.innerHTML += `
                    <th class="p-2 border-b-2 border-gray-200 text-center font-semibold">
                        <div class="${isToday ? 'text-blue-600' : ''}">
                            <div>${formatDate(day, { weekday: 'short' })}</div>
                            <div class="text-2xl">${formatDate(day, { day: 'numeric' })}</div>
                        </div>
                    </th>
                `;
            });
            plannerHead.appendChild(headerRow);
        };
        
        const renderPlanner = (week) => {
            plannerBody.innerHTML = '';
            teamMembers.forEach(member => {
                const row = document.createElement('tr');
                const regionHTML = member.region ? `<div class="text-xs text-gray-500">Region: ${member.region}</div>` : '';
                row.innerHTML = `
                    <td class="sticky left-0 bg-white border-b border-gray-200 p-2 z-10 align-top">
                        <div class="font-bold text-gray-900">${member.name}</div>
                        <div class="text-sm text-gray-500">${member.role}</div>
                        <div class="text-xs text-gray-500 mt-1">Shift: ${member.shift}</div>
                        ${regionHTML}
                        <div class="mt-2 space-x-2">
                           <button class="bulk-edit-btn text-xs text-blue-500 hover:underline" data-id="${member.id}">Bulk Edit</button>
                           <button class="delete-member-btn text-xs text-red-500 hover:underline" data-id="${member.id}">Delete</button>
                        </div>
                    </td>
                `;
                week.forEach(day => {
                    const dateString = toISODateString(day);
                    const statusKey = `${member.id}_${dateString}`;
                    const statusData = statuses[statusKey];
                    const statusClass = statusData ? `status-${statusData.status}` : 'status-default';
                    const commentIcon = statusData && statusData.comment ? `<span class="absolute bottom-1 right-1 text-xs">💬</span>` : '';
                    
                    const cell = document.createElement('td');
                    cell.className = 'border-b border-gray-200 p-1';
                    cell.innerHTML = `
                        <div class="status-cell relative rounded-lg cursor-pointer flex items-center justify-center ${statusClass}" data-member-id="${member.id}" data-date="${dateString}" title="${statusData?.comment || ''}">
                            ${commentIcon}
                        </div>
                    `;
                    row.appendChild(cell);
                });
                plannerBody.appendChild(row);
            });
        };

        const updateEmptyState = () => {
            if (teamMembers.length === 0) {
                emptyState.classList.remove('hidden');
                gridContainer.classList.add('hidden');
            } else {
                emptyState.classList.add('hidden');
                gridContainer.classList.remove('hidden');
            }
        };

        // EVENT HANDLERS
        document.getElementById('prev-week-btn').addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 7);
            render();
        });

        document.getElementById('next-week-btn').addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 7);
            render();
        });
        
        document.getElementById('today-btn').addEventListener('click', () => {
            currentDate = new Date();
            render();
        });
        
        document.getElementById('add-member-btn').addEventListener('click', () => {
            memberForm.reset();
            document.getElementById('member-id').value = '';
            memberModalTitle.textContent = 'Add New Member';
            memberModal.classList.remove('hidden');
        });
        
        document.getElementById('cancel-member-btn').addEventListener('click', () => {
            memberModal.classList.add('hidden');
        });

        memberForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const id = document.getElementById('member-id').value || `member-${Date.now()}`;
            const name = document.getElementById('member-name').value;
            const role = document.getElementById('member-role').value;
            const shift = document.getElementById('member-shift').value;
            const region = document.getElementById('member-region').value;
            
            const existingMemberIndex = teamMembers.findIndex(m => m.id === id);
            if (existingMemberIndex > -1) {
                teamMembers[existingMemberIndex] = { id, name, role, shift, region };
            } else {
                teamMembers.push({ id, name, role, shift, region });
            }
            saveData();
            render();
            memberModal.classList.add('hidden');
        });

        // Bulk Upload Handlers
        document.getElementById('bulk-upload-btn').addEventListener('click', () => {
            csvFileInput.value = ''; // Clear previous selection
            uploadStatus.textContent = ''; // Clear status message
            bulkUploadModal.classList.remove('hidden');
        });

        document.getElementById('cancel-upload-btn').addEventListener('click', () => {
            bulkUploadModal.classList.add('hidden');
        });

        csvFileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            uploadStatus.textContent = 'Processing...';

            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                complete: (results) => {
                    const data = results.data;
                    let importedCount = 0;
                    let membersToAdd = [];

                    const keys = results.meta.fields;
                    const nameKey = keys[0];
                    const roleKey = keys[1];
                    const shiftKey = keys[2];
                    const regionKey = keys[3];

                    data.forEach((row, index) => {
                        const name = row[nameKey]?.trim();
                        const role = row[roleKey]?.trim();
                        const shift = row[shiftKey]?.trim();
                        const region = regionKey ? row[regionKey]?.trim() : '';

                        if (name && role && shift) { // Name, Role, and Shift are required
                            membersToAdd.push({
                                id: `member-${Date.now()}-${index}`,
                                name,
                                role,
                                shift,
                                region: region || ''
                            });
                            importedCount++;
                        }
                    });

                    if (importedCount > 0) {
                        teamMembers.push(...membersToAdd);
                        saveData();
                        render();
                        uploadStatus.textContent = `${importedCount} members imported successfully!`;
                    } else {
                        uploadStatus.textContent = 'No valid members found. Please check the file format.';
                    }
                    csvFileInput.value = ''; // Clear the input
                },
                error: (err) => {
                    uploadStatus.textContent = `Error parsing file: ${err.message}`;
                    csvFileInput.value = '';
                }
            });
        });

        plannerBody.addEventListener('click', (e) => {
            const target = e.target;
            // Handle clicking a status cell
            if (target.closest('.status-cell')) {
                const cell = target.closest('.status-cell');
                selectedCellData = {
                    memberId: cell.dataset.memberId,
                    date: cell.dataset.date
                };
                const member = teamMembers.find(m => m.id === selectedCellData.memberId);
                const dateObj = new Date(selectedCellData.date);
                dateObj.setMinutes(dateObj.getMinutes() + dateObj.getTimezoneOffset()); // Adjust for timezone
                
                statusModalInfo.textContent = `For ${member.name} on ${formatDate(dateObj, { weekday: 'long', month: 'long', day: 'numeric' })}`;
                
                const statusKey = `${selectedCellData.memberId}_${selectedCellData.date}`;
                const statusData = statuses[statusKey];
                document.getElementById('status-comment').value = statusData?.comment || '';

                statusModal.classList.remove('hidden');
            }

            // Handle clicking the delete member button
            if (target.classList.contains('delete-member-btn')) {
                const memberId = target.dataset.id;
                // A custom confirmation dialog would be better, but for simplicity:
                if(confirm('Are you sure you want to delete this team member and all their status entries?')) {
                    teamMembers = teamMembers.filter(m => m.id !== memberId);
                    // Also delete their statuses
                    Object.keys(statuses).forEach(key => {
                        if (key.startsWith(memberId)) {
                            delete statuses[key];
                        }
                    });
                    saveData();
                    render();
                }
            }

            // Handle clicking the bulk edit button
            if (target.classList.contains('bulk-edit-btn')) {
                selectedMemberIdForBulkUpdate = target.dataset.id;
                const member = teamMembers.find(m => m.id === selectedMemberIdForBulkUpdate);
                bulkStatusModalInfo.textContent = `Set status for ${member.name} for the entire week.`;
                bulkStatusModal.classList.remove('hidden');
            }
        });
        
        // Single Status Modal Logic
        statusModal.addEventListener('click', (e) => {
            if (e.target.classList.contains('status-btn')) {
                const status = e.target.dataset.status;
                const comment = document.getElementById('status-comment').value;
                const key = `${selectedCellData.memberId}_${selectedCellData.date}`;
                statuses[key] = { status, comment };
                saveData();
                render();
                statusModal.classList.add('hidden');
            }
        });
        
        document.getElementById('save-status-btn').addEventListener('click', () => {
             const key = `${selectedCellData.memberId}_${selectedCellData.date}`;
             const comment = document.getElementById('status-comment').value;
             // Only update comment if a status is already set
             if (statuses[key]) {
                 statuses[key].comment = comment;
             }
             saveData();
             render();
             statusModal.classList.add('hidden');
        });

        document.getElementById('clear-status-btn').addEventListener('click', () => {
            const key = `${selectedCellData.memberId}_${selectedCellData.date}`;
            delete statuses[key];
            saveData();
            render();
            statusModal.classList.add('hidden');
        });
        
        document.getElementById('cancel-status-btn').addEventListener('click', () => {
            statusModal.classList.add('hidden');
        });

        // Bulk Status Modal Logic
        bulkStatusModal.addEventListener('click', (e) => {
            if (e.target.classList.contains('bulk-status-btn')) {
                const status = e.target.dataset.status;
                const week = getWeek(currentDate);
                week.forEach(day => {
                    // getDay() returns 0 for Sunday and 6 for Saturday.
                    // We only want to update for Monday (1) through Friday (5).
                    if (day.getDay() !== 0 && day.getDay() !== 6) {
                        const dateString = toISODateString(day);
                        const key = `${selectedMemberIdForBulkUpdate}_${dateString}`;
                        // For bulk updates, we clear any existing comment
                        statuses[key] = { status, comment: '' };
                    }
                });
                saveData();
                render();
                bulkStatusModal.classList.add('hidden');
            }
        });

        document.getElementById('cancel-bulk-status-btn').addEventListener('click', () => {
            bulkStatusModal.classList.add('hidden');
        });

        // Initial Render
        render();
    });
    </script>
    <script>
// Utility: Parse CSV text into array
function parseCSV(text) {
  return text
    .trim()
    .split("\n")
    .map(line => line.split(","));
}

// Utility: pick color based on status
function getColor(status) {
  switch (status.trim().toLowerCase()) {
    case "office": return "#006400";   // dark green
    case "home": return "#90EE90";     // light green
    case "leave": return "#D3D3D3";    // grey
    default: return "#ffffff";         // white
  }
}

fetch("Resourcetracker.csv")
  .then(response => response.text())
  .then(data => {
    const rows = parseCSV(data);

    // Assuming first row is header: [Name, Mon, Tue, Wed, Thu, Fri, Sat]
    const headers = rows[0];
    const people = rows.slice(1);

    const container = document.getElementById("planner");
    container.innerHTML = ""; // clear old content

    people.forEach(person => {
      const name = person[0];
      const rowDiv = document.createElement("div");
      rowDiv.className = "person-row";

      // Add name label
      const nameDiv = document.createElement("div");
      nameDiv.textContent = name;
      nameDiv.style.fontWeight = "bold";
      nameDiv.style.marginRight = "10px";
      rowDiv.appendChild(nameDiv);

      // Add colored cells for each day
      for (let i = 1; i < person.length; i++) {
        const status = person[i];
        const cell = document.createElement("div");
        cell.className = "day-cell";
        cell.style.display = "inline-block";
        cell.style.width = "60px";
        cell.style.height = "30px";
        cell.style.margin = "2px";
        cell.style.backgroundColor = getColor(status);
        rowDiv.appendChild(cell);
      }

      container.appendChild(rowDiv);
    });
  });
</script>
</body>
</html>


